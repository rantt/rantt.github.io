function rand(t,e){return Math.floor(Math.random()*(e-t+1))+t}var Game={w:800,h:600};Game.Boot=function(t){this.game=t},Game.Boot.prototype={preload:function(){this.game.stage.backgroundColor="#FFF",this.game.load.image("loading","assets/images/loading.png"),this.game.load.image("title","assets/images/title.png"),this.game.load.image("instructions","assets/images/instructions.png"),this.game.load.bitmapFont("minecraftia","assets/fonts/font.png","assets/fonts/font.xml"),this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.maxHeight=window.innerHeight,this.game.scale.maxWidth=window.innerHeight*(Game.w/Game.h)},create:function(){this.game.state.start("Load")}},Game.Load=function(t){this.game=t},Game.Load.prototype={preload:function(){var t=this.game.add.text(Game.w,Game.h,"Loading...",{font:"30px Helvetica",fill:"#000"});t.anchor.setTo(.5,.5);var e=this.game.add.sprite(Game.w/2-64,Game.h/2+50,"loading");this.game.load.setPreloadSprite(e),this.game.load.image("twitter","assets/images/twitter.png"),this.game.load.image("sky","assets/images/sky.png"),this.game.load.image("waves","assets/images/waves.png"),this.game.load.spritesheet("player","assets/images/player.png",96,96,4),this.game.load.atlasXML("shark","assets/images/shark.png","assets/atlas/shark.xml"),this.game.load.spritesheet("duck","assets/images/duck.png",64,64,2),this.game.load.audio("music","assets/audio/Tropical Adventure_0.mp3"),this.game.load.audio("hit","assets/audio/hit.wav")},create:function(){this.game.state.start("Menu")}},Game.Menu=function(t){this.game=t},Game.Menu.prototype={create:function(){this.scrollPosition=0,background=this.game.add.tileSprite(0,0,this.game.width,this.game.height,"sky"),background.tileScale.set(2),border=this.game.add.tileSprite(0,Game.h-160,this.game.width+512,160,"waves"),border.enableBody=!0,this.game.physics.arcade.enable(border),border.body.immovable=!0,border.body.allowGravity=!1,this.title=this.game.add.sprite(Game.w/2,Game.h/2-100,"title"),this.title.anchor.setTo(.5,.5),this.instructions=this.game.add.sprite(Game.w/2+200,200,"instructions"),this.instructions.scale.x=.5,this.instructions.scale.y=.5;var t=this.game.add.bitmapText(Game.w/2,Game.h/2+100,"minecraftia","~click to start~",24);t.anchor.setTo(.5)},update:function(){this.game.input.activePointer.isDown&&this.game.state.start("Play"),this.scrollPosition-=6,border.tilePosition.x=this.scrollPosition,background.tilePosition.x=.1*this.scrollPosition}};var wKey,aKey,sKey,dKey;Game.Play=function(t){this.game=t},Game.Play.prototype={init:function(){this.game.renderer.renderSession.roundPixels=!0,this.physics.startSystem(Phaser.Physics.ARCADE),this.physics.arcade.skipQuadTree=!1},create:function(){this.game.world.setBounds(0,0,Game.w,Game.h),this.game.stage.backgroundColor="#5fcde4",this.scrollPosition=0,this.score=0,this.music=this.game.add.sound("music"),this.music.play("",0,.3,!0),this.hitSnd=this.game.add.sound("hit"),this.hitSnd.volume=.5,background=this.game.add.tileSprite(0,0,this.game.width,this.game.height,"sky"),background.tileScale.set(2),border=this.game.add.tileSprite(0,Game.h-160,this.game.width+512,160,"waves"),border.enableBody=!0,this.game.physics.arcade.enable(border),border.body.immovable=!0,border.body.allowGravity=!1,this.player=this.game.add.sprite(192,Game.h-164,"player"),this.game.physics.arcade.enable(this.player),this.player.body.setSize(32,64),this.player.scale.x=2,this.player.scale.y=2,this.player.anchor.setTo(.5),this.player.animations.add("surf",[0,1,0],10,!0),this.player.play("surf"),this.enemies=this.game.add.group(),this.timer=this.game.time.events.loop(1600,this.addEnemies,this),wKey=this.game.input.keyboard.addKey(Phaser.Keyboard.W),aKey=this.game.input.keyboard.addKey(Phaser.Keyboard.A),sKey=this.game.input.keyboard.addKey(Phaser.Keyboard.S),dKey=this.game.input.keyboard.addKey(Phaser.Keyboard.D),this.cursors=this.game.input.keyboard.createCursorKeys(),this.tweening=!1,this.playAgainText=this.game.add.bitmapText(Game.w+100,this.game.world.centerY,"minecraftia","test",48),this.scoreText=this.game.add.bitmapText(Game.w-200,24,"minecraftia","Score: "+this.score,24),this.loadTouchControls(),wKey.onDown.add(function(){this.jump()},this),this.cursors.up.onDown.add(function(){this.jump()},this),sKey.onDown.add(function(){this.duck()},this),this.cursors.down.onDown.add(function(){this.duck()},this),this.twitterButton=this.game.add.button(this.game.world.centerX,this.game.world.centerY+200,"twitter",this.twitter,this),this.twitterButton.anchor.set(.5),this.twitterButton.visible=!1},loadTouchControls:function(){var t=80;this.arrowbmd=this.game.add.bitmapData(t,t),this.arrowbmd.ctx.clearRect(0,0,t,t),this.arrowbmd.ctx.strokeStyle="white",this.arrowbmd.ctx.lineWidth=2,this.arrowbmd.ctx.fill(),this.arrowbmd.ctx.beginPath(),this.arrowbmd.ctx.moveTo(1*t/2,0),this.arrowbmd.ctx.lineTo(0,1*t/2),this.arrowbmd.ctx.lineTo(1*t/4,1*t/2),this.arrowbmd.ctx.lineTo(1*t/4,t),this.arrowbmd.ctx.lineTo(3*t/4,t),this.arrowbmd.ctx.lineTo(3*t/4,1*t/2),this.arrowbmd.ctx.lineTo(t,1*t/2),this.arrowbmd.ctx.fill(),this.upArrow=this.game.add.sprite(100,Game.h-160,this.arrowbmd),this.upArrow.tint=14474460,this.upArrow.alpha=.5,this.upArrow.anchor.setTo(.5,.5),this.upArrow.inputEnabled=!0,this.upArrow.events.onInputDown.add(this.jump,this),this.upArrow.visible=!1,this.downArrow=this.game.add.sprite(100,Game.h-40,this.arrowbmd),this.downArrow.tint=14474460,this.downArrow.alpha=.5,this.downArrow.anchor.setTo(.5,.5),this.downArrow.inputEnabled=!0,this.downArrow.angle=180,this.downArrow.events.onInputDown.add(this.duck,this),this.downArrow.visible=!1,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?(this.upArrow.visible=!0,this.downArrow.visible=!0):(this.upArrow.visible=!1,this.downArrow.visible=!1)},addEnemies:function(){if(this.player.alive!==!1){this.score+=10,this.scoreText.setText("Score: "+this.score);var t;0===rand(0,1)?(t=this.add.sprite(Game.w,Game.h-164,"shark"),t.animations.add("bite",[0,1,2],20),t.anchor.setTo(0,-.5),this.game.physics.arcade.enable(t),t.checkWorldBounds=!0,t.outOfBoundsKill=!0,t.bite=!1,t.body.immovable=!0,console.log(t)):(t=this.add.sprite(Game.w,Game.h/2+100,"duck"),t.animations.add("fly",[0,1],5,!0),t.play("fly"),t.anchor.setTo(.5),this.game.physics.arcade.enable(t),t.body.setSize(32,32),t.checkWorldBounds=!0,t.outOfBoundsKill=!0,t.bite=!1,t.body.immovable=!0,console.log(t)),this.enemies.add(t),t.body.velocity.x=-355}},jump:function(){if(!this.tweening){this.tweening=!0,this.player.animations.stop(),this.player.frame=3;var t=this.game.add.tween(this.player).to({y:Game.h-300},400,Phaser.Easing.Linear.None).to({y:Game.h-164},400,Phaser.Easing.Linear.None).start();t.onComplete.add(function(){this.tweening=!1},this)}},duck:function(){if(!this.tweening){this.tweening=!0,this.player.animations.stop(),this.player.frame=2;var t=this.game.add.tween(this.player).to({y:Game.h-64},400,Phaser.Easing.Linear.None).to({y:Game.h-164},400,Phaser.Easing.Linear.None).start();t.onComplete.add(function(){this.tweening=!1},this)}},makeBox:function(t,e){var i=this.game.add.bitmapData(t,e);return i.ctx.beginPath(),i.ctx.rect(0,0,t,e),i.ctx.fillStyle="#fff",i.ctx.fill(),i},checkOverlap:function(t,e){var i=t.getBounds(),a=e.getBounds();return Phaser.Rectangle.intersects(i,a)},update:function(){this.player.alive===!0?(this.tweening||this.player.play("surf"),this.game.physics.arcade.collide(this.player,this.enemies,function(t,e){e.play("bite"),this.player.kill(),this.hitSnd.play(),console.log("hit")},null,this)):(this.playAgainText.setText("Play Again?"),this.game.time.events.add(1.5*Phaser.Timer.SECOND,function(){this.game.add.tween(this.playAgainText).to({x:this.game.world.centerX-300},355,Phaser.Easing.Linear.None).start(),this.twitterButton.visible=!0},this),(this.game.input.activePointer.isDown||wKey.isDown||this.cursors.up.isDown)&&(this.enemies.forEach(function(t){t.alive=!1}),this.music.stop(),this.player.alive=!0,this.game.state.start("Play"))),this.scrollPosition-=6,border.tilePosition.x=this.scrollPosition,background.tilePosition.x=.1*this.scrollPosition},twitter:function(){var t="http://www.divideby5.com/games/surfdude/",e="rantt_",i=[""];window.open("http://twitter.com/share?text=My+best+score+is+"+this.score+"+playing+Surf+Dude+See+if+you+can+beat+it.+at&via="+e+"&url="+t+"&hashtags="+i.join(","),"_blank")}};var game=new Phaser.Game(Game.w,Game.h,Phaser.AUTO,"game");game.state.add("Boot",Game.Boot),game.state.add("Load",Game.Load),game.state.add("Menu",Game.Menu),game.state.add("Play",Game.Play),game.state.start("Boot");