function rand(t,e){return Math.floor(Math.random()*(e-t+1))+t}var Game={w:600,h:800};null===localStorage.getItem("atSuperScoopersHighestScore")&&localStorage.setItem("atSuperScoopersHighestScore",0),Game.Boot=function(t){this.game=t},Game.Boot.prototype={preload:function(){this.game.load.image("loading","assets/images/loading.png"),this.game.load.image("title","assets/images/title.png"),this.game.load.image("instructions","assets/images/instructions.png"),this.game.load.bitmapFont("minecraftia","assets/fonts/font.png","assets/fonts/font.xml"),this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.maxHeight=window.innerHeight,this.game.scale.maxWidth=window.innerHeight*(Game.w/Game.h)},create:function(){this.game.state.start("Load")}},Game.Load=function(t){this.game=t},Game.Load.prototype={preload:function(){var t=this.game.add.text(Game.w,Game.h,"Loading...",{font:"30px Helvetica",fill:"#000"});t.anchor.setTo(.5,.5);var e=this.game.add.sprite(Game.w/2-64,Game.h/2+50,"loading");this.game.load.setPreloadSprite(e),this.game.load.image("twitter","assets/images/twitter.png"),this.game.load.spritesheet("npcs","assets/images/npcs.png",256,256,25),this.game.load.image("cart","assets/images/cart.png"),this.game.load.spritesheet("speech","assets/images/speech.png",50,50,3),this.game.load.spritesheet("cones","assets/images/cones.png",64,64,4),this.game.load.spritesheet("scoops","assets/images/scoops-sheet.png",64,64,3),this.game.load.image("strike","assets/images/strike.png"),this.game.load.audio("music","assets/audio/music_box_monster.mp3")},create:function(){this.game.state.start("Menu")}};var Icecream=function(t,e,s,a,i){this.game=t,this.toppings=a||[],this.toppingHeight=0,this.scale=i||1,this.mycone=this.game.add.group(),this.xpos=e,this.ypos=s;for(var o=0;o<this.toppings.length;o++){switch(1===o&&(this.toppingHeight+=15*this.scale),this.toppings[o]){case"cone":this.mycone.add(this.game.add.sprite(this.xpos,this.ypos+200-this.toppingHeight,"cones",2));break;case"waffle_cone":this.mycone.add(this.game.add.sprite(this.xpos,this.ypos+200-this.toppingHeight,"cones",3));break;case"vanilla":this.mycone.add(this.game.add.sprite(this.xpos,this.ypos+200-this.toppingHeight,"scoops",0));break;case"strawberry":this.mycone.add(this.game.add.sprite(this.xpos,this.ypos+200-this.toppingHeight,"scoops",1));break;case"chocolate":this.mycone.add(this.game.add.sprite(this.xpos,this.ypos+200-this.toppingHeight,"scoops",2))}this.toppingHeight+=15*this.scale}this.mycone.forEach(function(t){t.anchor.setTo(.5),t.scale.x=this.scale,t.scale.y=this.scale},this)};Icecream.prototype=Object.create(Phaser.Sprite.prototype),Icecream.prototype.add=function(t){var e;if(!(0===this.toppings.length&&"cone"!==t&&"waffle_cone"!==t||this.toppings.length>0&&("cone"===t||"waffle_cone"===t))){switch(1==this.toppings.length&&(this.toppingHeight+=15*this.scale),t){case"cone":e=this.game.add.sprite(this.xpos,this.ypos+200-this.toppingHeight,"cones",2);break;case"waffle_cone":e=this.game.add.sprite(this.xpos,this.ypos+200-this.toppingHeight,"cones",3);break;case"vanilla":e=this.game.add.sprite(this.xpos,this.ypos+200-this.toppingHeight,"scoops",0);break;case"strawberry":e=this.game.add.sprite(this.xpos,this.ypos+200-this.toppingHeight,"scoops",1);break;case"chocolate":e=this.game.add.sprite(this.xpos,this.ypos+200-this.toppingHeight,"scoops",2)}this.toppingHeight+=15*this.scale,e.anchor.setTo(.5),e.scale.x=this.scale,e.scale.y=this.scale,this.toppings.push(t),this.mycone.add(e);this.game.add.tween(e).to({y:Game.h/2+200-this.toppingHeight},300,Phaser.Easing.Quadratic.InOut).start()}},Icecream.prototype.kill=function(){this.mycone.forEach(function(t){t.kill()},this)},Icecream.prototype.constructor=Icecream;var Actor=function(t,e,s,a){this.game=t,this.walk_time=1e3,this.active=!1,this.wait=s,this.order=e,this.orderReceived=!1,this.icecream,this.facing_frame=a,this.walking_frame=a+3,Phaser.Sprite.call(this,this.game,Game.w-100,Game.h/2,"npcs",this.facing_frame),this.anchor.setTo(.5),this.scale.x=1,this.scale.y=1,this.game.add.existing(this)};Actor.prototype=Object.create(Phaser.Sprite.prototype),Actor.prototype.reset=function(t,e,s){this.walk_time=1e3,this.active=!1,this.wait=e,this.order=t,this.orderReceived=!1,this.icecream,this.facing_frame=s,this.walking_frame=s+3,this.frame=s,this.alive=!0,Phaser.Sprite.call(this,this.game,Game.w-100,Game.h/2,"npcs",this.facing_frame),this.anchor.setTo(.5),this.scale.x=1,this.scale.y=1},Actor.prototype.walkin=function(){if(!this.walking){this.walking=!0;var t=this.game.add.tween(this).to({x:Game.w/2-50},this.walk_time,Phaser.Easing.Linear.None).start();this.frame=this.walking_frame,t.onComplete.add(function(){this.active=!0,this.wait=this.game.time.now+this.wait,this.speech=this.game.add.group();for(var t=2,e=0;t>e;e++){var s=e;2==t&&1===e&&(s=2);var a=this.game.add.sprite(Game.w/2-200,Game.h/2-100-100*e,"speech",s);a.anchor.setTo(.5),a.scale.x=2,a.scale.y=2,a.tint=14474460,this.speech.add(a)}this.icecream=new Icecream(this.game,Game.w/2-200,Game.h/2-300,this.order,.75),this.walking=!1,this.frame=this.facing_frame},this)}},Actor.prototype.walkout=function(){if(!this.walking){this.speech.forEach(function(t){t.kill()},this),this.orderReceived===!1?this.icecream.kill():this.icecream.mycone.forEach(function(t){this.game.add.tween(t).to({x:-100,y:t.y+200},this.walk_time+200,Phaser.Easing.Linear.None).start()},this),this.walking=!0,this.frame=this.walking_frame;var t=this.game.add.tween(this).to({x:-100},this.walk_time,Phaser.Easing.Linear.None).start();t.onComplete.add(function(){this.kill(),this.icecream.kill(),this.walking=!1},this)}},Actor.prototype.constructor=Actor;var strikes=0;Game.Menu=function(t){this.game=t},Game.Menu.prototype={create:function(){var t=this.game.add.sprite(Game.w/2,Game.h-150,"cart");t.anchor.setTo(.5),this.game.stage.backgroundColor="#63E1FF";var e=this.game.add.bitmapText(Game.w/2,100,"minecraftia","Super Scoopers",42);e.anchor.setTo(.5);var s=this.game.add.sprite(Game.w/2,Game.h/2-50,"cones",2);s.anchor.setTo(.5),s.scale.x=2,s.scale.y=2;var a=this.game.add.sprite(Game.w/2,100,"scoops",0);a.anchor.setTo(.5),a.scale.x=2,a.scale.y=2;var i=(this.game.add.tween(a).to({y:Game.h/2-125},500,"Linear").start(),this.game.add.bitmapText(Game.w/2,Game.h/2+50,"minecraftia","~click to start~",24));if(i.anchor.setTo(.5),this.highestScore=parseInt(JSON.parse(localStorage.getItem("atSuperScoopersHighestScore"))),this.highestScore>0){var o=this.game.add.bitmapText(Game.w/2,Game.h-200,"minecraftia","High Score: $"+this.highestScore,48);o.tint=16776960,o.anchor.setTo(.5),this.twitterButton=this.game.add.button(this.game.world.centerX,this.game.world.centerY+300,"twitter",this.twitter,this),this.twitterButton.anchor.set(.5)}},twitter:function(){var t="http://www.divideby5.com/games/superscoopers/",e="rantt_",s=["onegameaweek"];window.open("http://twitter.com/share?text=My+best+score+is+$"+this.highestScore+"+playing+Super+Scoopers+See+if+you+can+beat+it.+at&via="+e+"&url="+t+"&hashtags="+s.join(","),"_blank")},update:function(){this.game.input.activePointer.isDown&&(strikes=0,this.game.state.start("Play"))}};var wKey,aKey,sKey,dKey,score=0,toppingHeight=0,level=1,customers=money=0,delay,scoopmax,strikes=0,levelNames=["First Day","Doing Pretty Good","Scoop Pro","Super Scooper!","Scooptacular","Wrists of Steel"];Game.Play=function(t){this.game=t},Game.Play.prototype={create:function(){this.game.world.setBounds(0,0,Game.w,Game.h),this.game.stage.backgroundColor="#63E1FF",this.highestScore=parseInt(JSON.parse(localStorage.getItem("atSuperScoopersHighestScore"))),this.music=this.game.add.sound("music"),this.music.volume=.5,this.music.loop=!0,this.music.play(),wKey=this.game.input.keyboard.addKey(Phaser.Keyboard.W),aKey=this.game.input.keyboard.addKey(Phaser.Keyboard.A),sKey=this.game.input.keyboard.addKey(Phaser.Keyboard.S),dKey=this.game.input.keyboard.addKey(Phaser.Keyboard.D),this.actor=new Actor(this.game,["waffle_cone","strawberry"],6e3,10),this.actor.walkin();var t=this.game.add.sprite(Game.w/2,Game.h-150,"cart");t.anchor.setTo(.5),this.placedOrder=new Icecream(this.game,Game.w/2,Game.h/2),this.chocolate_button=this.game.add.button(40,Game.h-260,"scoops",function(){this.placedOrder.add("chocolate")},this),this.chocolate_button.frame=2,this.strawberry_button=this.game.add.button(115,Game.h-260,"scoops",function(){this.placedOrder.add("strawberry")},this),this.strawberry_button.frame=1,this.vanilla_button=this.game.add.button(190,Game.h-260,"scoops",function(){this.placedOrder.add("vanilla")},this),this.vanilla_button.frame=0,this.cone_button=this.game.add.button(Game.w-110,Game.h-275,"cones",function(){this.placedOrder.add("cone")},this),this.cone_button.frame=2,this.waffle_cone_button=this.game.add.button(Game.w-110,Game.h-210,"cones",function(){this.placedOrder.add("waffle_cone")},this),this.waffle_cone_button.frame=3,this.lvlText=this.game.add.bitmapText(24,24,"minecraftia","Lvl: "+levelNames[0],24),this.moneyText=this.game.add.bitmapText(Game.w-150,24,"minecraftia","$"+money,24),this.moneyText.tint=65280,this.strike1=this.game.add.sprite(24,64,"strike"),this.strike1.visible=!1,this.strike2=this.game.add.sprite(74,64,"strike"),this.strike2.visible=!1,this.strike3=this.game.add.sprite(124,64,"strike"),this.strike3.visible=!1,this.twitterButton=this.game.add.button(this.game.world.centerX,this.game.world.centerY+200,"twitter",this.twitter,this),this.twitterButton.anchor.set(.5),this.twitterButton.visible=!1},update:function(){if(strikes>=3&&(money>this.highestScore&&(this.highestScore=money,localStorage.setItem("atSuperScoopersHighestScore",money)),this.music.stop(),this.game.state.start("Menu")),this.actor.active===!0&&this.game.time.now>this.actor.wait&&this.actor.alive===!0&&(money-=this.placedOrder.toppings.length,this.moneyText.setText("$"+money),money<0&&(this.moneyText.tint=16711680),this.actor.walkout(),this.placedOrder.kill(),this.placedOrder=new Icecream(this.game,Game.w/2,Game.h/2)),JSON.stringify(this.actor.order)===JSON.stringify(this.placedOrder.toppings)&&this.actor.alive===!0&&(1>strikes&&(this.strike1.visible=!1),2>strikes&&(this.strike2.visible=!1),3>strikes&&(this.strike3.visible=!1),money+=2*this.placedOrder.toppings.length,this.moneyText.setText("$"+money),money>0&&(this.moneyText.tint=65280),customers++,this.actor.orderReceived=!0,this.actor.walkout(),this.placedOrder.mycone.forEach(function(t){var e=this.game.add.tween(t).to({alpha:0},1e3,Phaser.Easing.Linear.None).start();e.onComplete.add(function(){t.kill()},this)},this),this.placedOrder=new Icecream(this.game,Game.w/2,Game.h/2)),this.actor.alive===!1){this.actor.orderReceived===!1&&strikes++,strikes>0&&(this.strike1.visible=!0),strikes>1&&(this.strike2.visible=!0),strikes>2&&(this.strike3.visible=!0),5>customers?(delay=6e3,scoopmax=1):10>customers?(delay=6e3,scoopmax=2,this.lvlText.setText("Lvl: "+levelNames[1])):15>customers?(delay=6e3,scoopmax=3,this.lvlText.setText("Lvl: "+levelNames[2])):20>customers?(delay=6e3,scoopmax=4,this.lvlText.setText("Lvl: "+levelNames[3])):25>customers?(delay=6e3,scoopmax=5,this.lvlText.setText("Lvl: "+levelNames[4])):customers%5===0&&(scoopmax=customers/5,delay=1e3*scoopmax,this.lvlText.setText("Lvl: "+levelNames[5]));var t=[0,5,10,15];this.actor.reset(this.rndOrder(rand(1,scoopmax)),delay,t[rand(0,3)]),this.actor.walkin()}},rndOrder:function(t){var e=["cone","waffle_cone"],s=["vanilla","chocolate","strawberry"],a=[];a.push(e[rand(0,1)]);for(var i=0;t>i;i++)a.push(s[rand(0,2)]);return a},twitter:function(){var t="http://www.divideby5.com/games/GAMETITLE/",e="rantt_",s=["1GAM"];window.open("http://twitter.com/share?text=My+best+score+is+"+score+"+playing+GAME+TITLE+See+if+you+can+beat+it.+at&via="+e+"&url="+t+"&hashtags="+s.join(","),"_blank")},render:function(){this.game.debug.body(this.actor)}};var game=new Phaser.Game(Game.w,Game.h,Phaser.AUTO,"game");game.state.add("Boot",Game.Boot),game.state.add("Load",Game.Load),game.state.add("Menu",Game.Menu),game.state.add("Play",Game.Play),game.state.start("Boot");