function makeBox(t,a,e){var i=this.game.add.bitmapData(t,a);return i.ctx.beginPath(),i.ctx.rect(0,0,t,a),i.ctx.fillStyle=e,i.ctx.fill(),i}var Game={w:1024,h:768};Game.Boot=function(t){this.game=t},Game.Boot.prototype={preload:function(){this.game.stage.backgroundColor="#dcdcdc",this.game.load.image("loading","assets/images/loading.png"),this.game.load.image("title","assets/images/title.png"),this.game.load.image("instructions","assets/images/instructions.png"),this.game.load.bitmapFont("minecraftia","assets/fonts/font.png","assets/fonts/font.xml"),this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.maxHeight=window.innerHeight,this.game.scale.maxWidth=window.innerHeight*(Game.w/Game.h)},create:function(){this.game.state.start("Load")}},Game.Load=function(t){this.game=t},Game.Load.prototype={preload:function(){var t=(this.game.add.bitmapText(Game.w/2,Game.h/2,"minecraftia","Loading...",30).anchor.setTo(.5),this.game.add.sprite(Game.w/2-64,Game.h/2+50,"loading"));this.game.load.setPreloadSprite(t),this.game.load.image("twitter","assets/images/twitter.png"),this.game.load.atlasXML("animals","assets/images/animals.png","assets/atlas/animals.xml"),this.game.load.audio("flip","assets/audio/flip.wav"),this.game.load.audio("shuffle","assets/audio/shuffle.wav"),this.game.load.audio("match","assets/audio/match.wav"),this.game.load.audio("applause","assets/audio/applause.wav"),this.game.load.image("easy","assets/images/easy.png"),this.game.load.image("normal","assets/images/normal.png"),this.game.load.image("hard","assets/images/hard.png"),this.game.load.atlasXML("startbtn","assets/images/startbtn.png","assets/atlas/startbtn.xml")},create:function(){this.game.state.start("Menu")}};var Card=function(t,a,e,i,s){this.game=t,this.index=s,this.facing="back",Phaser.Group.call(this,t),this.flipSnd=this.game.add.sound("flip"),this.flipSnd.volume=.3,this.face=this.create(a,e,i,s),this.face.scale.x=0,this.face.inputEnabled=!0,this.face.anchor.set(.5),this.back=this.create(a,e,makeBox(145,145,"blue")),this.back.anchor.set(.5),this.back.inputEnabled=!0,this.back.events.onInputDown.add(this.show,this)};Card.prototype=Object.create(Phaser.Group.prototype),Card.prototype.show=function(){this.flipSnd.play(),this.facing="face";var t=this.game.add.tween(this.back.scale).to({x:0},100),a=this.game.add.tween(this.face.scale).to({x:1},100);t.chain(a),t.start()},Card.prototype.hide=function(){this.flipSnd.play(),this.facing="back";var t=this.game.add.tween(this.back.scale).to({x:1},100),a=this.game.add.tween(this.face.scale).to({x:0},100);a.chain(t),a.start()},Card.prototype.constructor=Card;var difficulty;Game.Menu=function(t){this.game=t},Game.Menu.prototype={create:function(){difficulty="normal",this.game.stage.backgroundColor="#dcdcdc",this.titleText=this.game.add.bitmapText(Game.w/2,Game.h/2-100,"minecraftia","MEMORY\nMATCHER",64),this.titleText.anchor.setTo(.5),this.titleText.tint=255,this.game.add.tween(this.titleText).to({y:300},1e3,Phaser.Easing.Linear.In,!0,0,-1).yoyo(!0),this.difficultyButtons=this.game.add.group(),this.easyButton=this.game.add.button(Game.w/2,Game.h/2+75,"easy",this.difficultySelect,this),this.easyButton.anchor.setTo(.5),this.difficultyButtons.add(this.easyButton),this.normalButton=this.game.add.button(Game.w/2,Game.h/2+110,"normal",this.difficultySelect,this),this.normalButton.anchor.setTo(.5),this.normalButton.tint=255,this.difficultyButtons.add(this.normalButton),this.hardButton=this.game.add.button(Game.w/2,Game.h/2+155,"hard",this.difficultySelect,this),this.hardButton.anchor.setTo(.5),this.difficultyButtons.add(this.hardButton),this.startButton=this.game.add.button(Game.w/2,Game.h/2+220,"startbtn",this.begin,this,1),this.startButton.anchor.setTo(.5),this.twitterButton=this.game.add.button(this.game.world.centerX,Game.h-50,"twitter",this.twitter,this),this.twitterButton.anchor.set(.5),this.twitterButton.visible=!0},begin:function(){this.game.state.start("Play")},difficultySelect:function(t){this.difficultyButtons.forEach(function(t){t.tint=16777215}),t.tint=255,difficulty=t.key},makeBox:function(t,a){var e=this.game.add.bitmapData(t,a);return e.ctx.beginPath(),e.ctx.rect(0,0,t,a),e.ctx.fillStyle="#0000ff",e.ctx.lineStyle=4,e.ctx.strokeStyle="#ff00ff",e.ctx.fill(),e},twitter:function(){var t="http://www.divideby5.com/games/memorymatcher/",a="rantt_",e=[""];window.open("http://twitter.com/share?text=Play+Memory+Matcher+at&via="+a+"&url="+t+"&hashtags="+e.join(","),"_blank")}};var wKey,aKey,sKey,dKey,fails=0,score=0,cards,gameOver=!1;Game.Play=function(t){this.game=t},Game.Play.prototype={create:function(){this.game.world.setBounds(0,0,Game.w,Game.h),"easy"===difficulty?(pairs=6,card_cols=4):"normal"===difficulty?(pairs=8,card_cols=4):"hard"===difficulty&&(pairs=10,card_cols=5),this.matchSnd=this.game.add.sound("match"),this.matchSnd.volume=.3,this.applauseSnd=this.game.add.sound("applause"),this.applauseSnd.volume=.2,this.shuffleSnd=this.game.add.sound("shuffle"),this.shuffleSnd.volume=.3,this.shuffleSnd.play(),this.startTime=this.game.time.time;for(var t=[],a=[],e=[],i=0;10>i;i++)t.push(i);for(var i=0;i<pairs;i++){var s=Phaser.ArrayUtils.removeRandomItem(t);a.push(s),a.push(s)}e=this.shuffle(a),cards=this.game.add.group();for(var n=(Game.w-160*(card_cols-1))/2,i=0;i<2*pairs;i++){var h=i%card_cols*150+n,o=150*Math.floor(i/card_cols)+150,m=new Card(this.game,0,0,"animals",e[i]);this.game.add.tween(m).to({x:h,y:o},300).start(),m.back.events.onInputUp.add(this.check,this),cards.add(m)}this.failsText=this.game.add.bitmapText(Game.w-200,10,"minecraftia","Fails: "+fails,24),this.runningTimeText=this.game.add.bitmapText(20,20,"minecraftia","00:00",32),this.playAgainText=this.game.add.bitmapText(Game.w+100,this.game.world.centerY,"minecraftia","test",48),this.twitterButton=this.game.add.button(this.game.world.centerX,this.game.world.centerY+200,"twitter",this.twitter,this),this.twitterButton.anchor.set(.5),this.twitterButton.visible=!1},check:function(){var t=[];if(cards.forEach(function(a){"face"===a.facing&&t.push(a)},this),2===t.length)t[0].index===t[1].index?(this.matchSnd.play(),score+=1,this.game.add.tween(t[0].face.scale).to({x:0,y:0},100).start(),this.game.add.tween(t[1].face.scale).to({x:0,y:0},100).start(),this.game.time.events.add(.5*Phaser.Timer.SECOND,function(){t[0].destroy(),t[1].destroy()},this)):this.game.time.events.add(.5*Phaser.Timer.SECOND,function(){fails+=1,t[0].hide(),t[1].hide()},this);else if(t.length>2)for(var a=0;a<t.length;a++)fails+=1,t[a].hide();score>=pairs&&(gameOver=!0)},shuffle:function(t){for(var a=t.slice(),e=[];a.length>0;){var i=Math.floor(Math.random()*a.length);e.push(a.splice(i,1)[0])}return e},updateRunningTime:function(){this.runningTime=this.game.time.time-this.startTime,minutes=Math.floor(this.runningTime/6e4)%60,seconds=Math.floor(this.runningTime/1e3)%60,milliseconds=Math.floor(this.runningTime)%100,minutes<10&&(minutes="0"+minutes),seconds<10&&(seconds="0"+seconds),milliseconds<10&&(milliseconds="0"+milliseconds),"00"!=minutes?this.runningTimeText.setText(minutes+":"+seconds+":"+milliseconds):this.runningTimeText.setText(seconds+":"+milliseconds)},update:function(){gameOver===!1?(this.updateRunningTime(),this.failsText.setText("Fails: "+fails)):(this.applauseSnd.play(),this.playAgainText.setText("Play Again?"),this.game.time.events.add(.5*Phaser.Timer.SECOND,function(){this.game.add.tween(this.playAgainText).to({x:this.game.world.centerX-300},300,Phaser.Easing.Linear.None).start(),this.twitterButton.visible=!0},this),this.game.input.activePointer.isDown&&(this.applauseSnd.stop(),gameOver=!1,fails=0,score=0,this.game.state.start("Menu")))},twitter:function(){var t="http://www.divideby5.com/games/memorymatcher/",a="rantt_",e=[""];window.open("http://twitter.com/share?text=I+beat+Memory+Matcher+in+"+this.runningTimeText.text+"+See+if+you+can+beat+it.+at&via="+a+"&url="+t+"&hashtags="+e.join(","),"_blank")}};var game=new Phaser.Game(Game.w,Game.h,Phaser.AUTO,"game");game.state.add("Boot",Game.Boot),game.state.add("Load",Game.Load),game.state.add("Menu",Game.Menu),game.state.add("Play",Game.Play),game.state.start("Boot");